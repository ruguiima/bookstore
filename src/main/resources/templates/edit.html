<!DOCTYPE html>
<html lang="zh-CN" x-data="editApp" x-init="init()">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä¿®æ”¹å›¾ä¹¦ - å›¾ä¹¦å•†åŸ</title>
  <link rel="stylesheet" href="/styles.css" />
  <style>
    .upload-container{width:min(720px,94vw);margin:2rem auto;background:rgba(11,17,32,.75);border:1px solid var(--border);border-radius:1rem;padding:1.2rem;box-shadow:var(--shadow);}
    .upload-form{display:grid;gap:.9rem;}
    .upload-form .row{display:grid;gap:.45rem;}
    .upload-form input[type=text],
    .upload-form input[type=number],
    .upload-form input[type=file],
    .upload-form textarea{border:1px solid var(--border);background:#0b1120;color:var(--text);border-radius:.6rem;padding:.65rem .75rem;font-size:.95rem;}
    .upload-form textarea{min-height:120px;resize:vertical;}
    .actions{display:flex;gap:.8rem;margin-top:.6rem;}
    .status{margin-top:.6rem;font-size:.9rem;min-height:1.2rem;}
    .current-cover{margin-top:0.5rem;max-width:200px;border-radius:0.5rem;}
  </style>
  <script defer src="/app.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
<header class="header">
  <div class="brand"><span class="brand-logo">ğŸ“š</span><span class="brand-name">å›¾ä¹¦å•†åŸ</span></div>
  <div></div>
  <div class="header-actions">
    <a class="link" href="/index">è¿”å›é¦–é¡µ</a>
  </div>
</header>
<main class="upload-container">
  <h1 style="margin:.2rem 0 1rem;font-size:1.3rem;">ä¿®æ”¹å›¾ä¹¦</h1>
  <div x-show="loading" class="status">æ­£åœ¨åŠ è½½å›¾ä¹¦ä¿¡æ¯...</div>
  <div x-show="error" class="status" x-text="error" style="color: #ef4444;"></div>
  <form class="upload-form" enctype="multipart/form-data" @submit.prevent="submit" x-show="!loading && !error">
    <div class="row">
      <label for="title">æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰</label>
      <input id="title" name="title" type="text" required placeholder="è¯·è¾“å…¥å›¾ä¹¦æ ‡é¢˜" x-model="book.title" />
    </div>
    <div class="row">
      <label for="author">ä½œè€…ï¼ˆå¯ç©ºï¼‰</label>
      <input id="author" name="author" type="text" placeholder="ä½œè€…" x-model="book.author" />
    </div>
    <div class="row">
      <label for="category">åˆ†ç±»ï¼ˆå¯ç©ºï¼‰</label>
      <input id="category" name="category" type="text" placeholder="åˆ†ç±»" x-model="book.category" />
    </div>
    <div class="row" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.8rem;">
      <div class="row"><label for="price">ç°ä»·ï¼ˆå¯ç©ºï¼‰</label><input id="price" name="price" type="number" step="0.01" min="0" placeholder="ç°ä»·" x-model="book.price" /></div>
      <div class="row"><label for="originalPrice">åŸä»·ï¼ˆå¯ç©ºï¼‰</label><input id="originalPrice" name="originalPrice" type="number" step="0.01" min="0" placeholder="åŸä»·" x-model="book.originalPrice" /></div>
      <div class="row"><label for="rating">è¯„åˆ†ï¼ˆ0-5ï¼Œå¯ç©ºï¼‰</label><input id="rating" name="rating" type="number" step="0.1" min="0" max="5" placeholder="è¯„åˆ†" x-model="book.rating" /></div>
    </div>
    <div class="row">
      <label for="keywords">å…³é”®è¯ï¼ˆå¯ç©ºï¼Œä½¿ç”¨é€—å·æˆ–ç©ºæ ¼åˆ†éš”ï¼‰</label>
      <input id="keywords" name="keywords" type="text" placeholder="ä¾‹å¦‚: Java, å¹¶å‘" x-model="book.keywords" />
    </div>
    <div class="row">
      <label for="desc">ç®€ä»‹ï¼ˆå¯ç©ºï¼‰</label>
      <textarea id="desc" name="desc" placeholder="å›¾ä¹¦ç®€ä»‹" x-model="book.description"></textarea>
    </div>
    <div class="row">
      <label for="cover">å°é¢ï¼ˆå¯ç©ºï¼Œä¸é€‰æ‹©åˆ™ä¿æŒåŸå°é¢ï¼‰</label>
      <input id="cover" name="cover" type="file" accept="image/*" />
      <div x-show="book.cover" style="margin-top:0.5rem;">
        <p style="font-size:0.9rem;color:var(--muted);">å½“å‰å°é¢:</p>
        <img :src="book.cover" alt="å½“å‰å°é¢" class="current-cover" />
      </div>
    </div>
    <div class="actions">
      <button type="submit" class="btn-primary" :disabled="submitting">ä¿å­˜ä¿®æ”¹</button>
      <button type="button" class="btn" @click="window.history.back()" :disabled="submitting">å–æ¶ˆ</button>
    </div>
    <div class="status" x-text="status"></div>
  </form>
</main>
</body>
</html>

