<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä¸Šä¼ å›¾ä¹¦ - å›¾ä¹¦å•†åŸ</title>
  <link rel="stylesheet" href="/styles.css" />
  <style>
    .upload-container{width:min(720px,94vw);margin:2rem auto;background:rgba(11,17,32,.75);border:1px solid var(--border);border-radius:1rem;padding:1.2rem;box-shadow:var(--shadow);}
    .upload-form{display:grid;gap:.9rem;}
    .upload-form .row{display:grid;gap:.45rem;}
    .upload-form input[type=text],
    .upload-form input[type=number],
    .upload-form input[type=file],
    .upload-form textarea{border:1px solid var(--border);background:#0b1120;color:var(--text);border-radius:.6rem;padding:.65rem .75rem;font-size:.95rem;}
    .upload-form textarea{min-height:120px;resize:vertical;}
    .actions{display:flex;gap:.8rem;margin-top:.6rem;}
    .status{margin-top:.6rem;font-size:.9rem;min-height:1.2rem;}
  </style>
</head>
<body>
<header class="header">
  <div class="brand"><span class="brand-logo">ğŸ“š</span><span class="brand-name">å›¾ä¹¦å•†åŸ</span></div>
  <div></div>
  <div class="header-actions">
    <a class="link" href="/index">è¿”å›é¦–é¡µ</a>
  </div>
</header>
<main class="upload-container">
  <h1 style="margin:.2rem 0 1rem;font-size:1.3rem;">ä¸Šä¼ å›¾ä¹¦</h1>
  <form id="bookUploadForm" class="upload-form" enctype="multipart/form-data">
    <div class="row">
      <label for="title">æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰</label>
      <input id="title" name="title" type="text" required placeholder="è¯·è¾“å…¥å›¾ä¹¦æ ‡é¢˜" />
    </div>
    <div class="row">
      <label for="author">ä½œè€…ï¼ˆå¯ç©ºï¼‰</label>
      <input id="author" name="author" type="text" placeholder="ä½œè€…" />
    </div>
    <div class="row">
      <label for="category">åˆ†ç±»ï¼ˆå¯ç©ºï¼‰</label>
      <input id="category" name="category" type="text" placeholder="åˆ†ç±»" />
    </div>
    <div class="row" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.8rem;">
      <div class="row"><label for="price">ç°ä»·ï¼ˆå¯ç©ºï¼‰</label><input id="price" name="price" type="number" step="0.01" min="0" placeholder="ç°ä»·" /></div>
      <div class="row"><label for="originalPrice">åŸä»·ï¼ˆå¯ç©ºï¼‰</label><input id="originalPrice" name="originalPrice" type="number" step="0.01" min="0" placeholder="åŸä»·" /></div>
      <div class="row"><label for="rating">è¯„åˆ†ï¼ˆ0-5ï¼Œå¯ç©ºï¼‰</label><input id="rating" name="rating" type="number" step="0.1" min="0" max="5" placeholder="è¯„åˆ†" /></div>
    </div>
    <div class="row">
      <label for="keywords">å…³é”®è¯ï¼ˆå¯ç©ºï¼Œä½¿ç”¨é€—å·æˆ–ç©ºæ ¼åˆ†éš”ï¼‰</label>
      <input id="keywords" name="keywords" type="text" placeholder="ä¾‹å¦‚: Java, å¹¶å‘" />
    </div>
    <div class="row">
      <label for="desc">ç®€ä»‹ï¼ˆå¯ç©ºï¼‰</label>
      <textarea id="desc" name="desc" placeholder="å›¾ä¹¦ç®€ä»‹"></textarea>
    </div>
    <div class="row">
      <label for="cover">å°é¢ï¼ˆå¯ç©ºï¼‰</label>
      <input id="cover" name="cover" type="file" accept="image/*" />
    </div>
    <div class="actions">
      <button type="submit" class="btn-primary">æäº¤</button>
      <button type="reset" class="btn">é‡ç½®</button>
    </div>
    <div id="status" class="status"></div>
  </form>
</main>
<script>
  const form = document.getElementById('bookUploadForm');
  const statusEl = document.getElementById('status');
  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    statusEl.textContent = 'æ­£åœ¨æäº¤...';
    const fd = new FormData(form);
    try {
      const resp = await fetch('/api/books',{method:'POST',body:fd});
      if(!resp.ok){ statusEl.textContent='æäº¤å¤±è´¥ ('+resp.status+')'; return; }
      const data = await resp.json();
      statusEl.textContent = 'ä¸Šä¼ æˆåŠŸï¼ŒID='+data.id+'ã€‚åˆ·æ–°é¦–é¡µå³å¯æŸ¥çœ‹ã€‚';
      form.reset();
    }catch(err){
      console.error(err);
      statusEl.textContent='æäº¤å¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•ã€‚';
    }
  });
</script>
</body>
</html>

